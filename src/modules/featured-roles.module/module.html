{% set dataQueryData = module.data_query.data.CRM %}

{% set roleCollection = dataQueryData.company_collection.items[0].associations.p_role_collection__role_to_company %}

{% set roles = roleCollection.items %}

{% if roles|length > 0 %}
    <h2>Featured Roles</h2>
    {% for role in roles %}
        {% set company = dataQueryData.company_collection.items[0] %}
        
        {% set roleDetailLink = "{{ request.path }}?role_identifier={{role.role_identifier}}&title={{role.title}}&job_title={{role.title}}" %}
        <div class="role-card" onclick="window.location='{{ roleDetailLink }}'">
            <h1>{{ role.title }}</h1>
            <h2>{{ company.name }}</h2>
            <p>{{ truncate(role.description, 128, false, '...') }}</p>
            <a class="button" href="{{ roleDetailLink }}">View Role</a>
        </div>    
    {% endfor %}
{% endif %}